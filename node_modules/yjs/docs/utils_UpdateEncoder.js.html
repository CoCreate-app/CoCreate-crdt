

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: utils/UpdateEncoder.js | yjs</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
        
            <link type="text/css" rel="stylesheet" href="./style.css">
        
    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 162px; height: 162px">
        
            <a href="/" rel="noopener noreferrer" target="_blank">
                <img src="https://yjs.dev/images/logo/yjs-512x512.png" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">yjs</a></h1>
        
            <span class="version">v13.4.0</span>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Modules</h3><ul><li><a href="module-encoding.html">encoding</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:encoding_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-encoding.html#.applyUpdate">applyUpdate</a></li><li><a href="module-encoding.html#.applyUpdateV2">applyUpdateV2</a></li><li><a href="module-encoding.html#.decodeStateVector">decodeStateVector</a></li><li><a href="module-encoding.html#.decodeStateVectorV2">decodeStateVectorV2</a></li><li><a href="module-encoding.html#.encodeStateAsUpdate">encodeStateAsUpdate</a></li><li><a href="module-encoding.html#.encodeStateAsUpdateV2">encodeStateAsUpdateV2</a></li><li><a href="module-encoding.html#.encodeStateVector">encodeStateVector</a></li><li><a href="module-encoding.html#.encodeStateVectorV2">encodeStateVectorV2</a></li><li><a href="module-encoding.html#.readStateVector">readStateVector</a></li><li><a href="module-encoding.html#.readUpdate">readUpdate</a></li><li><a href="module-encoding.html#.readUpdateV2">readUpdateV2</a></li><li><a href="module-encoding.html#.writeDocumentStateVector">writeDocumentStateVector</a></li><li><a href="module-encoding.html#.writeStateAsUpdate">writeStateAsUpdate</a></li><li><a href="module-encoding.html#.writeStateVector">writeStateVector</a></li><li><a href="module-encoding.html#~cleanupPendingStructs">cleanupPendingStructs</a></li><li><a href="module-encoding.html#~writeStructs">writeStructs</a></li></ul></div></li><li><a href="module-Y.html">Y</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:Y_sub"><div class="member-type">Typedef</div><ul class="inner"><li><a href="module-Y.html#~DocOpts">DocOpts</a></li></ul></div></li><li><a href="module-YArray.html">YArray</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YArray_sub"></div></li><li><a href="module-YMap.html">YMap</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YMap_sub"></div></li><li><a href="module-YText.html">YText</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YText_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-YText.html#.cleanupYTextFormatting">cleanupYTextFormatting</a></li><li><a href="module-YText.html#.parent">parent</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-YText.html#~cleanupContextlessFormattingGap">cleanupContextlessFormattingGap</a></li><li><a href="module-YText.html#~cleanupFormattingGap">cleanupFormattingGap</a></li><li><a href="module-YText.html#~equalAttrs">equalAttrs</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="module-YText.html#~DeltaItem">DeltaItem</a></li><li><a href="module-YText.html#~TextAttributes">TextAttributes</a></li></ul></div></li><li><a href="module-YXml.html">YXml</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YXml_sub"><div class="member-type">Typedef</div><ul class="inner"><li><a href="module-YXml.html#~CSS_Selector">CSS_Selector</a></li><li><a href="module-YXml.html#~domFilter">domFilter</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="AbsolutePosition_AbsolutePosition.html">AbsolutePosition</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AbsolutePosition#AbsolutePosition_sub"></div></li><li><a href="AbstractConnector.html">AbstractConnector</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AbstractConnector_sub"></div></li><li><a href="AbstractContent.html">AbstractContent</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AbstractContent_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="AbstractContent.html#copy">copy</a></li><li><a href="AbstractContent.html#delete">delete</a></li><li><a href="AbstractContent.html#gc">gc</a></li><li><a href="AbstractContent.html#getContent">getContent</a></li><li><a href="AbstractContent.html#getLength">getLength</a></li><li><a href="AbstractContent.html#getRef">getRef</a></li><li><a href="AbstractContent.html#integrate">integrate</a></li><li><a href="AbstractContent.html#isCountable">isCountable</a></li><li><a href="AbstractContent.html#mergeWith">mergeWith</a></li><li><a href="AbstractContent.html#splice">splice</a></li><li><a href="AbstractContent.html#write">write</a></li></ul></div></li><li><a href="AbstractDSDecoder_AbstractDSDecoder.html">AbstractDSDecoder</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AbstractDSDecoder#AbstractDSDecoder_sub"></div></li><li><a href="AbstractStruct_AbstractStruct.html">AbstractStruct</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AbstractStruct#AbstractStruct_sub"></div></li><li><a href="AbstractType.html">AbstractType</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AbstractType_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="AbstractType.html#_dEH">_dEH</a></li><li><a href="AbstractType.html#_eH">_eH</a></li><li><a href="AbstractType.html#_first">_first</a></li><li><a href="AbstractType.html#_item">_item</a></li><li><a href="AbstractType.html#_map">_map</a></li><li><a href="AbstractType.html#_searchMarker">_searchMarker</a></li><li><a href="AbstractType.html#_start">_start</a></li><li><a href="AbstractType.html#doc">doc</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="AbstractType.html#_callObserver">_callObserver</a></li><li><a href="AbstractType.html#_copy">_copy</a></li><li><a href="AbstractType.html#_integrate">_integrate</a></li><li><a href="AbstractType.html#_write">_write</a></li><li><a href="AbstractType.html#observe">observe</a></li><li><a href="AbstractType.html#observeDeep">observeDeep</a></li><li><a href="AbstractType.html#toJSON">toJSON</a></li><li><a href="AbstractType.html#unobserve">unobserve</a></li><li><a href="AbstractType.html#unobserveDeep">unobserveDeep</a></li></ul></div></li><li><a href="ArraySearchMarker_ArraySearchMarker.html">ArraySearchMarker</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ArraySearchMarker#ArraySearchMarker_sub"></div></li><li><a href="ContentAny_ContentAny.html">ContentAny</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ContentAny#ContentAny_sub"></div></li><li><a href="ContentBinary_ContentBinary.html">ContentBinary</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ContentBinary#ContentBinary_sub"></div></li><li><a href="ContentDeleted_ContentDeleted.html">ContentDeleted</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ContentDeleted#ContentDeleted_sub"></div></li><li><a href="DeleteItem_DeleteItem.html">DeleteItem</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="DeleteItem#DeleteItem_sub"></div></li><li><a href="DeleteSet.html">DeleteSet</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="DeleteSet_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="DeleteSet.html#clients">clients</a></li></ul></div></li><li><a href="DSDecoderV1_DSDecoderV1.html">DSDecoderV1</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="DSDecoderV1#DSDecoderV1_sub"></div></li><li><a href="DSDecoderV2_DSDecoderV2.html">DSDecoderV2</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="DSDecoderV2#DSDecoderV2_sub"></div></li><li><a href="ID_ID.html">ID</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ID#ID_sub"></div></li><li><a href="Item.html">Item</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Item_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Item.html#content">content</a></li><li><a href="Item.html#deleted">deleted</a></li><li><a href="Item.html#info">info</a></li><li><a href="Item.html#keep">keep</a></li><li><a href="Item.html#lastId">lastId</a></li><li><a href="Item.html#left">left</a></li><li><a href="Item.html#marker">marker</a></li><li><a href="Item.html#next">next</a></li><li><a href="Item.html#origin">origin</a></li><li><a href="Item.html#parent">parent</a></li><li><a href="Item.html#parent">parent</a></li><li><a href="Item.html#parent">parent</a></li><li><a href="Item.html#parent">parent</a></li><li><a href="Item.html#parentSub">parentSub</a></li><li><a href="Item.html#prev">prev</a></li><li><a href="Item.html#redone">redone</a></li><li><a href="Item.html#right">right</a></li><li><a href="Item.html#rightOrigin">rightOrigin</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Item.html#delete">delete</a></li><li><a href="Item.html#gc">gc</a></li><li><a href="Item.html#getMissing">getMissing</a></li><li><a href="Item.html#integrate">integrate</a></li><li><a href="Item.html#mergeWith">mergeWith</a></li><li><a href="Item.html#write">write</a></li></ul></div></li><li><a href="module-Y.Doc.html">Doc</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:Y.Doc_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-Y.Doc.html#_item">_item</a></li><li><a href="module-Y.Doc.html#_transaction">_transaction</a></li><li><a href="module-Y.Doc.html#_transactionCleanups">_transactionCleanups</a></li><li><a href="module-Y.Doc.html#share">share</a></li><li><a href="module-Y.Doc.html#subdocs">subdocs</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-Y.Doc.html#destroy">destroy</a></li><li><a href="module-Y.Doc.html#get">get</a></li><li><a href="module-Y.Doc.html#getArray">getArray</a></li><li><a href="module-Y.Doc.html#getMap">getMap</a></li><li><a href="module-Y.Doc.html#getText">getText</a></li><li><a href="module-Y.Doc.html#getXmlFragment">getXmlFragment</a></li><li><a href="module-Y.Doc.html#load">load</a></li><li><a href="module-Y.Doc.html#off">off</a></li><li><a href="module-Y.Doc.html#on">on</a></li><li><a href="module-Y.Doc.html#toJSON">toJSON</a></li><li><a href="module-Y.Doc.html#transact">transact</a></li></ul></div></li><li><a href="module-YArray.YArray.html">YArray</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YArray.YArray_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-YArray.YArray.html#_prelimContent">_prelimContent</a></li><li><a href="module-YArray.YArray.html#_searchMarker">_searchMarker</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-YArray.YArray.html#_callObserver">_callObserver</a></li><li><a href="module-YArray.YArray.html#_integrate">_integrate</a></li><li><a href="module-YArray.YArray.html#_write">_write</a></li><li><a href="module-YArray.YArray.html#delete">delete</a></li><li><a href="module-YArray.YArray.html#forEach">forEach</a></li><li><a href="module-YArray.YArray.html#get">get</a></li><li><a href="module-YArray.YArray.html#insert">insert</a></li><li><a href="module-YArray.YArray.html#map">map</a></li><li><a href="module-YArray.YArray.html#push">push</a></li><li><a href="module-YArray.YArray.html#Symbol.iterator">Symbol.iterator</a></li><li><a href="module-YArray.YArray.html#toArray">toArray</a></li><li><a href="module-YArray.YArray.html#toJSON">toJSON</a></li><li><a href="module-YArray.YArray.html#unshift">unshift</a></li></ul></div></li><li><a href="module-YArray.YArrayEvent.html">YArrayEvent</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YArray.YArrayEvent_sub"></div></li><li><a href="module-YMap.YMap.html">YMap</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YMap.YMap_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-YMap.YMap.html#size">size</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-YMap.YMap.html#_callObserver">_callObserver</a></li><li><a href="module-YMap.YMap.html#_integrate">_integrate</a></li><li><a href="module-YMap.YMap.html#_write">_write</a></li><li><a href="module-YMap.YMap.html#delete">delete</a></li><li><a href="module-YMap.YMap.html#entries">entries</a></li><li><a href="module-YMap.YMap.html#forEach">forEach</a></li><li><a href="module-YMap.YMap.html#get">get</a></li><li><a href="module-YMap.YMap.html#has">has</a></li><li><a href="module-YMap.YMap.html#keys">keys</a></li><li><a href="module-YMap.YMap.html#set">set</a></li><li><a href="module-YMap.YMap.html#Symbol.iterator">Symbol.iterator</a></li><li><a href="module-YMap.YMap.html#toJSON">toJSON</a></li><li><a href="module-YMap.YMap.html#values">values</a></li></ul></div></li><li><a href="module-YMap.YMapEvent.html">YMapEvent</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YMap.YMapEvent_sub"></div></li><li><a href="module-YText.ItemTextListPosition.html">ItemTextListPosition</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YText.ItemTextListPosition_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-YText.ItemTextListPosition.html#forward">forward</a></li></ul></div></li><li><a href="module-YText.YText.html">YText</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YText.YText_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-YText.YText.html#_pending">_pending</a></li><li><a href="module-YText.YText.html#_searchMarker">_searchMarker</a></li><li><a href="module-YText.YText.html#doc">doc</a></li><li><a href="module-YText.YText.html#length">length</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-YText.YText.html#_callObserver">_callObserver</a></li><li><a href="module-YText.YText.html#_integrate">_integrate</a></li><li><a href="module-YText.YText.html#_write">_write</a></li><li><a href="module-YText.YText.html#applyDelta">applyDelta</a></li><li><a href="module-YText.YText.html#delete">delete</a></li><li><a href="module-YText.YText.html#format">format</a></li><li><a href="module-YText.YText.html#insert">insert</a></li><li><a href="module-YText.YText.html#insertEmbed">insertEmbed</a></li><li><a href="module-YText.YText.html#toDelta">toDelta</a></li><li><a href="module-YText.YText.html#toJSON">toJSON</a></li><li><a href="module-YText.YText.html#toString">toString</a></li></ul></div></li><li><a href="module-YText.YTextEvent.html">YTextEvent</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YText.YTextEvent_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-YText.YTextEvent.html#_delta">_delta</a></li><li><a href="module-YText.YTextEvent.html#_delta">_delta</a></li><li><a href="module-YText.YTextEvent.html#delta">delta</a></li></ul></div></li><li><a href="module-YXml.YXmlFragment.html">YXmlFragment</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YXml.YXmlFragment_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-YXml.YXmlFragment.html#_prelimContent">_prelimContent</a></li><li><a href="module-YXml.YXmlFragment.html#_prelimContent">_prelimContent</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-YXml.YXmlFragment.html#_callObserver">_callObserver</a></li><li><a href="module-YXml.YXmlFragment.html#_integrate">_integrate</a></li><li><a href="module-YXml.YXmlFragment.html#_write">_write</a></li><li><a href="module-YXml.YXmlFragment.html#createTreeWalker">createTreeWalker</a></li><li><a href="module-YXml.YXmlFragment.html#delete">delete</a></li><li><a href="module-YXml.YXmlFragment.html#insert">insert</a></li><li><a href="module-YXml.YXmlFragment.html#querySelector">querySelector</a></li><li><a href="module-YXml.YXmlFragment.html#querySelectorAll">querySelectorAll</a></li><li><a href="module-YXml.YXmlFragment.html#toArray">toArray</a></li><li><a href="module-YXml.YXmlFragment.html#toDOM">toDOM</a></li><li><a href="module-YXml.YXmlFragment.html#toJSON">toJSON</a></li><li><a href="module-YXml.YXmlFragment.html#toString">toString</a></li></ul></div></li><li><a href="module-YXml.YXmlTreeWalker.html">YXmlTreeWalker</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:YXml.YXmlTreeWalker_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-YXml.YXmlTreeWalker.html#_currentNode">_currentNode</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-YXml.YXmlTreeWalker.html#next">next</a></li></ul></div></li><li><a href="PermanentUserData_PermanentUserData.html">PermanentUserData</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="PermanentUserData#PermanentUserData_sub"></div></li><li><a href="RelativePosition.html">RelativePosition</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="RelativePosition_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="RelativePosition.html#item">item</a></li><li><a href="RelativePosition.html#tname">tname</a></li><li><a href="RelativePosition.html#type">type</a></li></ul></div></li><li><a href="Snapshot_Snapshot.html">Snapshot</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Snapshot#Snapshot_sub"></div></li><li><a href="StackItem.html">StackItem</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="StackItem_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="StackItem.html#meta">meta</a></li></ul></div></li><li><a href="Transaction.html">Transaction</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Transaction_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Transaction.html#_mergeStructs">_mergeStructs</a></li><li><a href="Transaction.html#afterState">afterState</a></li><li><a href="Transaction.html#beforeState">beforeState</a></li><li><a href="Transaction.html#changed">changed</a></li><li><a href="Transaction.html#changedParentTypes">changedParentTypes</a></li><li><a href="Transaction.html#deleteSet">deleteSet</a></li><li><a href="Transaction.html#doc">doc</a></li><li><a href="Transaction.html#local">local</a></li><li><a href="Transaction.html#meta">meta</a></li><li><a href="Transaction.html#origin">origin</a></li><li><a href="Transaction.html#subdocsAdded">subdocsAdded</a></li><li><a href="Transaction.html#subdocsLoaded">subdocsLoaded</a></li><li><a href="Transaction.html#subdocsRemoved">subdocsRemoved</a></li></ul></div></li><li><a href="UndoManager.html">UndoManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="UndoManager_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="UndoManager.html#redoStack">redoStack</a></li><li><a href="UndoManager.html#undoing">undoing</a></li><li><a href="UndoManager.html#undoStack">undoStack</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="UndoManager.html#redo">redo</a></li><li><a href="UndoManager.html#stopCapturing">stopCapturing</a></li><li><a href="UndoManager.html#undo">undo</a></li></ul></div></li><li><a href="UpdateDecoderV2_UpdateDecoderV2.html">UpdateDecoderV2</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="UpdateDecoderV2#UpdateDecoderV2_sub"></div></li><li><a href="YEvent.html">YEvent</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="YEvent_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="YEvent.html#_changes">_changes</a></li><li><a href="YEvent.html#changes">changes</a></li><li><a href="YEvent.html#currentTarget">currentTarget</a></li><li><a href="YEvent.html#path">path</a></li><li><a href="YEvent.html#target">target</a></li><li><a href="YEvent.html#transaction">transaction</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="YEvent.html#adds">adds</a></li><li><a href="YEvent.html#deletes">deletes</a></li></ul></div></li><li><a href="YXmlElement.html">YXmlElement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="YXmlElement_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="YXmlElement.html#_prelimAttrs">_prelimAttrs</a></li><li><a href="YXmlElement.html#_prelimAttrs">_prelimAttrs</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="YXmlElement.html#_copy">_copy</a></li><li><a href="YXmlElement.html#_integrate">_integrate</a></li><li><a href="YXmlElement.html#_write">_write</a></li><li><a href="YXmlElement.html#getAttribute">getAttribute</a></li><li><a href="YXmlElement.html#getAttributes">getAttributes</a></li><li><a href="YXmlElement.html#removeAttribute">removeAttribute</a></li><li><a href="YXmlElement.html#setAttribute">setAttribute</a></li><li><a href="YXmlElement.html#toDOM">toDOM</a></li><li><a href="YXmlElement.html#toString">toString</a></li></ul></div></li><li><a href="YXmlEvent.html">YXmlEvent</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="YXmlEvent_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="YXmlEvent.html#attributesChanged">attributesChanged</a></li></ul></div></li><li><a href="YXmlHook.html">YXmlHook</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="YXmlHook_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="YXmlHook.html#hookName">hookName</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="YXmlHook.html#_copy">_copy</a></li><li><a href="YXmlHook.html#_write">_write</a></li><li><a href="YXmlHook.html#toDOM">toDOM</a></li></ul></div></li><li><a href="YXmlText.html">YXmlText</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="YXmlText_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="YXmlText.html#_write">_write</a></li><li><a href="YXmlText.html#toDOM">toDOM</a></li><li><a href="YXmlText.html#toJSON">toJSON</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#addChangedTypeToTransaction">addChangedTypeToTransaction</a></li><li><a href="global.html#callTypeObservers">callTypeObservers</a></li><li><a href="global.html#cleanupTransactions">cleanupTransactions</a></li><li><a href="global.html#compareIDs">compareIDs</a></li><li><a href="global.html#compareRelativePositions">compareRelativePositions</a></li><li><a href="global.html#contentRefs">contentRefs</a></li><li><a href="global.html#createAbsolutePosition">createAbsolutePosition</a></li><li><a href="global.html#createAbsolutePositionFromRelativePosition">createAbsolutePositionFromRelativePosition</a></li><li><a href="global.html#createDocFromSnapshot">createDocFromSnapshot</a></li><li><a href="global.html#createRelativePosition">createRelativePosition</a></li><li><a href="global.html#createRelativePositionFromJSON">createRelativePositionFromJSON</a></li><li><a href="global.html#createRelativePositionFromTypeIndex">createRelativePositionFromTypeIndex</a></li><li><a href="global.html#createSnapshot">createSnapshot</a></li><li><a href="global.html#decodeRelativePosition">decodeRelativePosition</a></li><li><a href="global.html#decodeSnapshot">decodeSnapshot</a></li><li><a href="global.html#decodeSnapshotV2">decodeSnapshotV2</a></li><li><a href="global.html#encodeRelativePosition">encodeRelativePosition</a></li><li><a href="global.html#encodeSnapshot">encodeSnapshot</a></li><li><a href="global.html#encodeSnapshotV2">encodeSnapshotV2</a></li><li><a href="global.html#equalSnapshots">equalSnapshots</a></li><li><a href="global.html#findIndexCleanStart">findIndexCleanStart</a></li><li><a href="global.html#findMarker">findMarker</a></li><li><a href="global.html#followRedone">followRedone</a></li><li><a href="global.html#getState">getState</a></li><li><a href="global.html#getStateVector">getStateVector</a></li><li><a href="global.html#getTypeChildren">getTypeChildren</a></li><li><a href="global.html#globalSearchMarkerTimestamp">globalSearchMarkerTimestamp</a></li><li><a href="global.html#isVisible">isVisible</a></li><li><a href="global.html#iterateDeletedStructs">iterateDeletedStructs</a></li><li><a href="global.html#iterateStructs">iterateStructs</a></li><li><a href="global.html#keepItem">keepItem</a></li><li><a href="global.html#logType">logType</a></li><li><a href="global.html#markPosition">markPosition</a></li><li><a href="global.html#mergeDeleteSets">mergeDeleteSets</a></li><li><a href="global.html#overwriteMarker">overwriteMarker</a></li><li><a href="global.html#popStackItem">popStackItem</a></li><li><a href="global.html#readContentAny">readContentAny</a></li><li><a href="global.html#readContentBinary">readContentBinary</a></li><li><a href="global.html#readContentFormat">readContentFormat</a></li><li><a href="global.html#readItemContent">readItemContent</a></li><li><a href="global.html#readRelativePosition">readRelativePosition</a></li><li><a href="global.html#readYXmlElement">readYXmlElement</a></li><li><a href="global.html#refreshMarkerTimestamp">refreshMarkerTimestamp</a></li><li><a href="global.html#snapshot">snapshot</a></li><li><a href="global.html#splitSnapshotAffectedStructs">splitSnapshotAffectedStructs</a></li><li><a href="global.html#transact">transact</a></li><li><a href="global.html#tryGc">tryGc</a></li><li><a href="global.html#tryGcDeleteSet">tryGcDeleteSet</a></li><li><a href="global.html#tryMergeDeleteSet">tryMergeDeleteSet</a></li><li><a href="global.html#tryToMergeWithLeft">tryToMergeWithLeft</a></li><li class="hidden"><a href="global.html#UndoManagerOptions">UndoManagerOptions</a></li><li><a href="global.html#updateMarkerChanges">updateMarkerChanges</a></li><li><a href="global.html#writeRelativePosition">writeRelativePosition</a></li><li><a href="global.html#writeUpdateMessageFromTransaction">writeUpdateMessageFromTransaction</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
import * as error from 'lib0/error.js'
import * as encoding from 'lib0/encoding.js'

import {
  ID // eslint-disable-line
} from '../internals.js'

export class AbstractDSEncoder {
  constructor () {
    this.restEncoder = encoding.createEncoder()
  }

  /**
   * @return {Uint8Array}
   */
  toUint8Array () {
    error.methodUnimplemented()
  }

  /**
   * Resets the ds value to 0.
   * The v2 encoder uses this information to reset the initial diff value.
   */
  resetDsCurVal () { }

  /**
   * @param {number} clock
   */
  writeDsClock (clock) { }

  /**
   * @param {number} len
   */
  writeDsLen (len) { }
}

export class AbstractUpdateEncoder extends AbstractDSEncoder {
  /**
   * @return {Uint8Array}
   */
  toUint8Array () {
    error.methodUnimplemented()
  }

  /**
   * @param {ID} id
   */
  writeLeftID (id) { }

  /**
   * @param {ID} id
   */
  writeRightID (id) { }

  /**
   * Use writeClient and writeClock instead of writeID if possible.
   * @param {number} client
   */
  writeClient (client) { }

  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeInfo (info) { }

  /**
   * @param {string} s
   */
  writeString (s) { }

  /**
   * @param {boolean} isYKey
   */
  writeParentInfo (isYKey) { }

  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeTypeRef (info) { }

  /**
   * Write len of a struct - well suited for Opt RLE encoder.
   *
   * @param {number} len
   */
  writeLen (len) { }

  /**
   * @param {any} any
   */
  writeAny (any) { }

  /**
   * @param {Uint8Array} buf
   */
  writeBuf (buf) { }

  /**
   * @param {any} embed
   */
  writeJSON (embed) { }

  /**
   * @param {string} key
   */
  writeKey (key) { }
}

export class DSEncoderV1 {
  constructor () {
    this.restEncoder = new encoding.Encoder()
  }

  toUint8Array () {
    return encoding.toUint8Array(this.restEncoder)
  }

  resetDsCurVal () {
    // nop
  }

  /**
   * @param {number} clock
   */
  writeDsClock (clock) {
    encoding.writeVarUint(this.restEncoder, clock)
  }

  /**
   * @param {number} len
   */
  writeDsLen (len) {
    encoding.writeVarUint(this.restEncoder, len)
  }
}

export class UpdateEncoderV1 extends DSEncoderV1 {
  /**
   * @param {ID} id
   */
  writeLeftID (id) {
    encoding.writeVarUint(this.restEncoder, id.client)
    encoding.writeVarUint(this.restEncoder, id.clock)
  }

  /**
   * @param {ID} id
   */
  writeRightID (id) {
    encoding.writeVarUint(this.restEncoder, id.client)
    encoding.writeVarUint(this.restEncoder, id.clock)
  }

  /**
   * Use writeClient and writeClock instead of writeID if possible.
   * @param {number} client
   */
  writeClient (client) {
    encoding.writeVarUint(this.restEncoder, client)
  }

  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeInfo (info) {
    encoding.writeUint8(this.restEncoder, info)
  }

  /**
   * @param {string} s
   */
  writeString (s) {
    encoding.writeVarString(this.restEncoder, s)
  }

  /**
   * @param {boolean} isYKey
   */
  writeParentInfo (isYKey) {
    encoding.writeVarUint(this.restEncoder, isYKey ? 1 : 0)
  }

  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeTypeRef (info) {
    encoding.writeVarUint(this.restEncoder, info)
  }

  /**
   * Write len of a struct - well suited for Opt RLE encoder.
   *
   * @param {number} len
   */
  writeLen (len) {
    encoding.writeVarUint(this.restEncoder, len)
  }

  /**
   * @param {any} any
   */
  writeAny (any) {
    encoding.writeAny(this.restEncoder, any)
  }

  /**
   * @param {Uint8Array} buf
   */
  writeBuf (buf) {
    encoding.writeVarUint8Array(this.restEncoder, buf)
  }

  /**
   * @param {any} embed
   */
  writeJSON (embed) {
    encoding.writeVarString(this.restEncoder, JSON.stringify(embed))
  }

  /**
   * @param {string} key
   */
  writeKey (key) {
    encoding.writeVarString(this.restEncoder, key)
  }
}

export class DSEncoderV2 {
  constructor () {
    this.restEncoder = new encoding.Encoder() // encodes all the rest / non-optimized
    this.dsCurrVal = 0
  }

  toUint8Array () {
    return encoding.toUint8Array(this.restEncoder)
  }

  resetDsCurVal () {
    this.dsCurrVal = 0
  }

  /**
   * @param {number} clock
   */
  writeDsClock (clock) {
    const diff = clock - this.dsCurrVal
    this.dsCurrVal = clock
    encoding.writeVarUint(this.restEncoder, diff)
  }

  /**
   * @param {number} len
   */
  writeDsLen (len) {
    if (len === 0) {
      error.unexpectedCase()
    }
    encoding.writeVarUint(this.restEncoder, len - 1)
    this.dsCurrVal += len
  }
}

export class UpdateEncoderV2 extends DSEncoderV2 {
  constructor () {
    super()
    /**
     * @type {Map&lt;string,number>}
     */
    this.keyMap = new Map()
    /**
     * Refers to the next uniqe key-identifier to me used.
     * See writeKey method for more information.
     *
     * @type {number}
     */
    this.keyClock = 0
    this.keyClockEncoder = new encoding.IntDiffOptRleEncoder()
    this.clientEncoder = new encoding.UintOptRleEncoder()
    this.leftClockEncoder = new encoding.IntDiffOptRleEncoder()
    this.rightClockEncoder = new encoding.IntDiffOptRleEncoder()
    this.infoEncoder = new encoding.RleEncoder(encoding.writeUint8)
    this.stringEncoder = new encoding.StringEncoder()
    this.parentInfoEncoder = new encoding.RleEncoder(encoding.writeUint8)
    this.typeRefEncoder = new encoding.UintOptRleEncoder()
    this.lenEncoder = new encoding.UintOptRleEncoder()
  }

  toUint8Array () {
    const encoder = encoding.createEncoder()
    encoding.writeUint8(encoder, 0) // this is a feature flag that we might use in the future
    encoding.writeVarUint8Array(encoder, this.keyClockEncoder.toUint8Array())
    encoding.writeVarUint8Array(encoder, this.clientEncoder.toUint8Array())
    encoding.writeVarUint8Array(encoder, this.leftClockEncoder.toUint8Array())
    encoding.writeVarUint8Array(encoder, this.rightClockEncoder.toUint8Array())
    encoding.writeVarUint8Array(encoder, encoding.toUint8Array(this.infoEncoder))
    encoding.writeVarUint8Array(encoder, this.stringEncoder.toUint8Array())
    encoding.writeVarUint8Array(encoder, encoding.toUint8Array(this.parentInfoEncoder))
    encoding.writeVarUint8Array(encoder, this.typeRefEncoder.toUint8Array())
    encoding.writeVarUint8Array(encoder, this.lenEncoder.toUint8Array())
    // @note The rest encoder is appended! (note the missing var)
    encoding.writeUint8Array(encoder, encoding.toUint8Array(this.restEncoder))
    return encoding.toUint8Array(encoder)
  }

  /**
   * @param {ID} id
   */
  writeLeftID (id) {
    this.clientEncoder.write(id.client)
    this.leftClockEncoder.write(id.clock)
  }

  /**
   * @param {ID} id
   */
  writeRightID (id) {
    this.clientEncoder.write(id.client)
    this.rightClockEncoder.write(id.clock)
  }

  /**
   * @param {number} client
   */
  writeClient (client) {
    this.clientEncoder.write(client)
  }

  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeInfo (info) {
    this.infoEncoder.write(info)
  }

  /**
   * @param {string} s
   */
  writeString (s) {
    this.stringEncoder.write(s)
  }

  /**
   * @param {boolean} isYKey
   */
  writeParentInfo (isYKey) {
    this.parentInfoEncoder.write(isYKey ? 1 : 0)
  }

  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeTypeRef (info) {
    this.typeRefEncoder.write(info)
  }

  /**
   * Write len of a struct - well suited for Opt RLE encoder.
   *
   * @param {number} len
   */
  writeLen (len) {
    this.lenEncoder.write(len)
  }

  /**
   * @param {any} any
   */
  writeAny (any) {
    encoding.writeAny(this.restEncoder, any)
  }

  /**
   * @param {Uint8Array} buf
   */
  writeBuf (buf) {
    encoding.writeVarUint8Array(this.restEncoder, buf)
  }

  /**
   * This is mainly here for legacy purposes.
   *
   * Initial we incoded objects using JSON. Now we use the much faster lib0/any-encoder. This method mainly exists for legacy purposes for the v1 encoder.
   *
   * @param {any} embed
   */
  writeJSON (embed) {
    encoding.writeAny(this.restEncoder, embed)
  }

  /**
   * Property keys are often reused. For example, in y-prosemirror the key `bold` might
   * occur very often. For a 3d application, the key `position` might occur very often.
   *
   * We cache these keys in a Map and refer to them via a unique number.
   *
   * @param {string} key
   */
  writeKey (key) {
    const clock = this.keyMap.get(key)
    if (clock === undefined) {
      this.keyClockEncoder.write(this.keyClock++)
      this.stringEncoder.write(key)
    } else {
      this.keyClockEncoder.write(this.keyClock++)
    }
  }
}
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://yjs.dev/images/logo/yjs-512x512.png" style="width: 162px; height: 162px">
    <div class="footer-text">Shared Editing</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
